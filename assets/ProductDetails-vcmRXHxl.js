import{u as z,a as A,b as I,c as q,r as i,d as F,j as e,e as E,f as P,C as B}from"./index-LnKsreFE.js";function Q(){const{id:p}=z(),c=A(),{add:b,totalQty:h}=I(),{token:g,name:v}=q(),[s,N]=i.useState(null),[C,m]=i.useState(!0),[a,k]=i.useState(null),[x,w]=i.useState(1),[R,f]=i.useState(!1),l=i.useRef(null),r=i.useRef(null),[o,d]=i.useState(null);if(i.useEffect(()=>{F.get(`/products/${p}`).then(t=>{N(t.data),m(!1)}).catch(t=>{console.error("Failed to fetch product",t),m(!1)})},[p]),C)return e.jsx("div",{style:{padding:40,textAlign:"center"},children:"Loading product..."});if(!s)return e.jsx("div",{style:{padding:40,textAlign:"center"},children:"Product not found."});const u=s.sizes?s.sizes.split(","):[],y=t=>{w(n=>Math.max(1,n+t))},S=()=>{if(!l.current||!r.current)return;const t=l.current.getBoundingClientRect(),n=r.current.getBoundingClientRect();d({src:s.image_url,style:{position:"fixed",top:t.top,left:t.left,width:t.width,height:t.height,opacity:1,zIndex:9999,borderRadius:"12px",pointerEvents:"none",transition:"none"}}),requestAnimationFrame(()=>{setTimeout(()=>{d({src:s.image_url,style:{position:"fixed",top:n.top+10,left:n.left+10,width:"20px",height:"20px",opacity:0,zIndex:9999,borderRadius:"50%",pointerEvents:"none",transition:"all 0.8s cubic-bezier(0.2, 1, 0.3, 1)"}})},20)}),setTimeout(()=>d(null),850)},j=async(t=!1)=>{if(u.length>0&&!a){alert("Please select a size first.");return}await b(s.id,x,a)&&(t?c("/checkout"):S())};return e.jsxs(e.Fragment,{children:[o&&e.jsx("img",{src:o.src,style:o.style,className:"flying-item",alt:""}),e.jsxs("div",{className:"home-icons",style:{display:"flex",alignItems:"center",padding:"20px 40px"},children:[e.jsx("button",{onClick:()=>c(-1),style:{position:"relative",color:"black",fontSize:18,cursor:"pointer",borderRadius:8,border:"1px solid rgba(0,0,0,0.12)",background:"white",top:10,left:30,padding:"10px 14px"},children:"← Back"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:20,marginLeft:"auto"},children:[e.jsxs("div",{ref:r,style:{position:"relative"},children:[e.jsx("img",{src:E,alt:"Cart",title:"Cart",onClick:()=>f(!0),style:{width:32,height:32,cursor:"pointer"}}),h>0&&e.jsx("span",{style:{position:"absolute",bottom:-5,left:-5,background:"black",color:"white",borderRadius:"50%",padding:"2px 6px",fontSize:12,fontWeight:"bold",minWidth:18,textAlign:"center"},children:h})]}),e.jsx("img",{src:P,alt:"Account",title:g?`Account (${v||"me"})`:"Login / Register",onClick:()=>c(g?"/account":"/login"),style:{width:32,height:32,cursor:"pointer"}})]})]}),e.jsxs("div",{className:"pdp-container fade-in",children:[e.jsx("div",{className:"pdp-image-container",children:e.jsx("img",{ref:l,src:s.image_url,alt:s.name,className:"pdp-image"})}),e.jsxs("div",{className:"pdp-info",children:[e.jsx("h1",{className:"pdp-name",children:s.name}),e.jsxs("div",{className:"pdp-price",children:["$",Number(s.price).toFixed(2)]}),e.jsx("p",{style:{color:"#666",lineHeight:"1.5"},children:s.description||"A classic essential for your wardrobe. Made with high-quality materials for lasting comfort and style."}),u.length>0&&e.jsxs("div",{className:"size-section",children:[e.jsxs("h4",{children:["Select Size: ",a]}),e.jsx("div",{className:"size-grids",children:u.map(t=>e.jsx("div",{className:`size-box ${a===t?"selected":""}`,onClick:()=>k(t),children:t},t))})]}),e.jsxs("div",{className:"qty-section",children:[e.jsx("h4",{children:"Quantity"}),e.jsxs("div",{className:"qty-wrapper",children:[e.jsx("button",{className:"qty-btn",onClick:()=>y(-1),children:"−"}),e.jsx("div",{className:"qty-display",children:x}),e.jsx("button",{className:"qty-btn",onClick:()=>y(1),children:"+"})]})]}),e.jsxs("div",{className:"pdp-actions",children:[e.jsx("button",{className:"btn-add-cart",onClick:()=>j(!1),children:"Add to Cart"}),e.jsx("button",{className:"btn-buy-now",onClick:()=>j(!0),children:"Buy Now"})]})]})]}),e.jsx(B,{isOpen:R,onClose:()=>f(!1)})]})}export{Q as default};
